<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rerun a lavaan Analysis (Leaving-One-Out-Each-Time) — lavaan_rerun • semfindr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Rerun a lavaan Analysis (Leaving-One-Out-Each-Time) — lavaan_rerun" />
<meta property="og:description" content="lavaan_rerun() reruns a lavaan analysis several
times, each time with one case removed." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semfindr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/semfindr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/selecting_cases.html">Selecting Cases In Rerun</a>
    </li>
    <li>
      <a href="../articles/user_id.html">Use Case IDs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sfcheung/semfindr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rerun a <code>lavaan</code> Analysis (Leaving-One-Out-Each-Time)</h1>
    <small class="dont-index">Source: <a href='https://github.com/sfcheung/semfindr/blob/master/R/lavaan_rerun.R'><code>R/lavaan_rerun.R</code></a></small>
    <div class="hidden name"><code>lavaan_rerun.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>lavaan_rerun()</code> reruns a <code>lavaan</code> analysis several
times, each time with one case removed.</p>
    </div>

    <pre class="usage"><span class='fu'>lavaan_rerun</span><span class='op'>(</span>
  <span class='va'>fit</span>,
  case_id <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>to_rerun</span>,
  <span class='va'>md_top</span>,
  <span class='va'>resid_md_top</span>,
  allow_inadmissible <span class='op'>=</span> <span class='cn'>FALSE</span>,
  skip_all_checks <span class='op'>=</span> <span class='cn'>FALSE</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  makeCluster_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>spec <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"cl.cores"</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fit</th>
      <td><p>The output from <code><a href='https://rdrr.io/pkg/lavaan/man/lavaan.html'>lavaan::lavaan()</a></code>, such as
<code><a href='https://rdrr.io/pkg/lavaan/man/cfa.html'>lavaan::cfa()</a></code> and <code><a href='https://rdrr.io/pkg/lavaan/man/sem.html'>lavaan::sem()</a></code>.</p></td>
    </tr>
    <tr>
      <th>case_id</th>
      <td><p>If it is a character vector of length equals to the
number of cases (the number of rows in the data in <code>fit</code>), then it
is the vector of case identification values. If it is <code>NULL</code>, the
default, then <code>case.idx</code> used by <code>lavaan</code> functions will be used
as case identification values. The case identification values will
be used to name the list of <em>n</em> output.</p></td>
    </tr>
    <tr>
      <th>to_rerun</th>
      <td><p>The cases to be processed. If <code>case_id</code> is
specified, this should be a subset of <code>case_id</code>. If <code>case_id</code> is
not specified, then this should be a vector of integers indicating
the rows to te processed, as appeared in the data in <code>fit</code>.
<code>to_rerun</code> cannot be used together with <code>md_top</code> or
<code>resid_md_top.</code></p></td>
    </tr>
    <tr>
      <th>md_top</th>
      <td><p>The number of cases to be processed based on the
Mahalanobis distance computed on all observed variables used in
the model. The cases will be ranked from the largest to the
smallest distance, and the top <code>md_top</code> case(s) will be processed.
<code>md_top</code> cannot be used together with <code>to_rerun</code> or
<code>resid_md_top.</code></p></td>
    </tr>
    <tr>
      <th>resid_md_top</th>
      <td><p>The number of cases to be processed based on
the Mahalanobis distance computed from the residuals of outcome
variables. The cases will be ranked from the largest to the
smallest distance, and the top <code>resid_md_top</code> case(s) will be
processed. <code>resid_md_top</code> cannot be used together with <code>to_rerun</code>
or <code>md_top.</code></p></td>
    </tr>
    <tr>
      <th>allow_inadmissible</th>
      <td><p>If <code>TRUE</code>, accepts a fit object with
inadmissible results (i.e., <code>post.check</code> from
<code><a href='https://rdrr.io/pkg/lavaan/man/lavInspect.html'>lavaan::lavInspect()</a></code> is <code>FALSE</code>). Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>skip_all_checks</th>
      <td><p>If <code>TRUE</code>, skips all checks and allow
users to run this function on any object of <code>lavaan</code> class.
For users to experiment this and other functions on models
not officially supported. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Whether parallel will be used. If <code>TRUE</code>, will use
functions in the <code>parallel</code> package to rerun the analysis.
Currently, only support <code>"snow"</code> type clusters using local CPU
cores. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>makeCluster_args</th>
      <td><p>A named list of arguments to be passed to
<code><a href='https://rdrr.io/r/parallel/makeCluster.html'>parallel::makeCluster()</a></code>. Default is <code>list(spec = getOption("cl.cores", 2)))</code>. If only the number of cores need to
be specified, use <code><a href='https://rdrr.io/r/base/list.html'>list(spec = x)</a></code>, where <code>x</code> is the number
of cores to use.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following elements:</p><ul>
<li><p><code>rerun</code>: The <em>n</em> <code>lavaan</code> output objects.</p></li>
<li><p><code>fit</code>: The original output from <code>lavaan</code>.</p></li>
<li><p><code>post_check</code>: A list of length equals to <em>n</em>. Each analysis was
checked by <a href='https://rdrr.io/pkg/lavaan/man/lavInspect.html'>lavaan::lavTech</a><code>(x, "post.check")</code>, <code>x</code> being the
<code>lavaan</code> results. The results of this test are stored in this
list. If the value is <code>TRUE</code>, the estimation converged and the
solution is admissible. If not <code>TRUE</code>, it is a warning message
issued by <code><a href='https://rdrr.io/pkg/lavaan/man/lavInspect.html'>lavaan::lavTech()</a></code>.</p></li>
<li><p><code>call</code>: The call to <code>lavaan_rerun()</code>.</p></li>
<li><p><code>selected</code>: A numeric vector of the row numbers of cases selected
in the analysis. Its length should be equal to the length of
<code>rerun</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>lavaan_rerun()</code> gets an <code><a href='https://rdrr.io/pkg/lavaan/man/lavaan.html'>lavaan::lavaan()</a></code> output and
reruns the analysis <em>n</em> times, using the same arguments and
options in the output, <em>n</em> equals to the number of cases. In each
run, one case will be removed.</p>
<p>Optionally, users can rerun the analysis with only selected cases
removed. These cases can be specified by case IDs, by Mahalanobis
distance computed from all variables used in the model, or by
Mahalanobis distance computed from the residuals (observed score -
implied scores) of observed outcome variables. See the help on the
arguments <code>to_rerun</code>, <code>md_top</code>, and <code>resid_md_top</code>.</p>
<p>It is not recommended to use Mahalanobis distance computed from all
variables, especially for models with observed variables as
predictors (Pek &amp; MacCallum, 2011). Cases that are extreme on
predictors may not be influential on the results. Nevertheless,
this distance is reported in some SEM programs and so this option
is provided.</p>
<p>Mahalanobis distance based on residuals are supported for models
with no latent factors. The implied scores are computed by
<code><a href='implied_scores.html'>implied_scores()</a></code>.</p>
<p>If the sample size is large, it is recommended to use parallel
processing. However, due to the nature of the <code><a href='https://rdrr.io/r/stats/update.html'>update()</a></code> method
for <a href='https://rdrr.io/pkg/lavaan/man/lavaan-class.html'>lavaan::lavaan</a> object, it is possible that parallel
processing will fail. If this is the case, try to use serial
processing, by simply remove the argument <code>parallel</code> or set it to
<code>FALSE</code>.</p>
<p>Many other functions in <a href='semfindr-package.html'>semfindr</a> use the output from
<code>lavaan_rerun()</code>. Instead of running the <em>n</em> analyses every time, do
this step once and then users can compute whatever influence
statistics they want quickly.</p>
<p>If the analysis took a few minutes to run due to the large number
of cases or the long processing time in fitting the model, it is
recommended to save the output to an external file (e.g., by
<code><a href='https://rdrr.io/r/base/readRDS.html'>base::saveRDS()</a></code>).</p>
<p>Currently <code>lavaan_rerun()</code> only supports single-group models.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Shu Fai Cheung (shufai.cheung@gmail.com)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://lavaan.ugent.be'>lavaan</a></span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>pa_dat</span>
<span class='co'># For illustration only, select only the first 50 cases</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span>, <span class='op'>]</span>
<span class='co'># The model</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span>
<span class='st'>"
m1 ~ iv1 + iv2
dv ~ m1
"</span>
<span class='co'># Fit the model</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>lavaan</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/sem.html'>sem</a></span><span class='op'>(</span><span class='va'>mod</span>, <span class='va'>dat</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
</div><div class='output co'>#&gt; lavaan 0.6-9 ended normally after 13 iterations
#&gt; 
#&gt;   Estimator                                         ML
#&gt;   Optimization method                           NLMINB
#&gt;   Number of model parameters                         5
#&gt;                                                       
#&gt;   Number of observations                            50
#&gt;                                                       
#&gt; Model Test User Model:
#&gt;                                                       
#&gt;   Test statistic                                 1.768
#&gt;   Degrees of freedom                                 2
#&gt;   P-value (Chi-square)                           0.413
#&gt; 
#&gt; Parameter Estimates:
#&gt; 
#&gt;   Standard errors                             Standard
#&gt;   Information                                 Expected
#&gt;   Information saturated (h1) model          Structured
#&gt; 
#&gt; Regressions:
#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)
#&gt;   m1 ~                                                
#&gt;     iv1              -0.159    0.166   -0.954    0.340
#&gt;     iv2               0.525    0.162    3.241    0.001
#&gt;   dv ~                                                
#&gt;     m1                0.350    0.161    2.169    0.030
#&gt; 
#&gt; Variances:
#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)
#&gt;    .m1                0.901    0.180    5.000    0.000
#&gt;    .dv                1.423    0.285    5.000    0.000
#&gt; </div><div class='input'><span class='co'># Fit the model n times. Each time with one case removed.</span>
<span class='va'>fit_rerun</span> <span class='op'>&lt;-</span> <span class='fu'>lavaan_rerun</span><span class='op'>(</span><span class='va'>fit</span>, parallel <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>The expected CPU time is 2.9 second(s).</span>
#&gt; <span class='message'>Could be faster if ran in parallel.</span></div><div class='input'><span class='co'># Results excluding the first case</span>
<span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitMeasures</a></span><span class='op'>(</span><span class='va'>fit_rerun</span><span class='op'>$</span><span class='va'>rerun</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"chisq"</span>, <span class='st'>"cfi"</span>, <span class='st'>"tli"</span>, <span class='st'>"rmsea"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; chisq   cfi   tli rmsea 
#&gt; 1.403 1.000 1.143 0.000 </div><div class='input'><span class='co'># Results by manually excluding the first case</span>
<span class='va'>fit_01</span> <span class='op'>&lt;-</span> <span class='fu'>lavaan</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/sem.html'>sem</a></span><span class='op'>(</span><span class='va'>mod</span>, <span class='va'>dat</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitMeasures</a></span><span class='op'>(</span><span class='va'>fit_01</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"chisq"</span>, <span class='st'>"cfi"</span>, <span class='st'>"tli"</span>, <span class='st'>"rmsea"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; chisq   cfi   tli rmsea 
#&gt; 1.403 1.000 1.143 0.000 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


